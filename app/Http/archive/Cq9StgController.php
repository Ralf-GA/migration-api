<?php

namespace App\Http\Controllers;

use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Http;
use Laravel\Lumen\Routing\Controller;

class Cq9StgController extends Controller
{
    public function migrate()
    {
        $response = Http::withHeaders([
            'Authorization' => env('CQ9_AUTH_TOKEN_STG'),
            'Content-Type' => 'application/x-www-form-urlencoded'
        ])->get(env('CQ9_API_URL_STG'))->json();

        if ($response['status']['code'] != '0')
            dd($response);

        $pos = 1;

        $test = [];

        foreach ($response['data'] as $game) {
            if ($game['gametype'] != 'slot') continue;

            $gameName = $game['gamename'];

            foreach ($game['nameset'] as $name) {
                if ($name['lang'] === 'en') {
                    $gameName = $name['name'];
                    break;
                }
            }

            $requestData[] = [
                'providerCode' => 'CQ9',
                'providerName' => 'CQ9',
                'gameCode' => (string) $game['gamecode'],
                'gameName' => $gameName,
                'position' => $pos,
                'type' => $game['gametype'],
                'rtp' => $this->gameRTP($game['gamecode']),
                'imageUrl' => '-',
                'imageAlt' => $gameName,
            ];

            $pos++;
        }

        // dd($test);
        // dd($requestData);

        // foreach ($requestData as $data) {
        //     $response = Http::withHeaders([
        //         'Authorization' => 'Bearer ' . env('BEARER_TOKEN_STG')
        //         // ])->post(env('ADD_GAME_API_STG'), $data);
        //     ])->post('dummyApi.com', $data);

        //     Log::info(json_encode([
        //         'request' => $data,
        //         'response' => $response->body()
        //     ]));
        // }
    }

    private function gameRTP($gameID)
    {
        // $rtps = [
        //     '52'    => '96.18',
        //     '7'     => '96.18',
        //     '179'   => '96.07',
        //     '105'   => '96.18',
        //     '31'    => '96.1',
        //     '133'   => '96.19',
        //     '111'   => '96.18',
        //     '10'    => '96.02',
        //     '64'    => '96.18',
        //     '137'   => '96.18',
        //     '160'   => '96.19',
        //     '99'    => '96.18',
        //     '127'   => '96.1',
        //     '208'   => '96.15',
        //     '50'    => '96.19',
        //     '117'   => '96.04',
        //     '109'   => '96.18',
        //     '108'   => '96.18',
        //     '188'   => '95.97',
        //     '69'    => '96.07',
        //     '116'   => '96.09',
        //     '180'   => '96.04',
        //     '113'   => '96.04',
        //     '140'   => '96',
        //     '89'    => '95.96',
        //     '147'   => '96',
        //     '123'   => '96.02',
        //     '138'   => '96.18',
        //     '182'   => '96.19',
        //     '205'   => '96.18',
        //     '9'     => '96.1',
        //     '83'    => '96.02',
        //     '74'    => '96.06',
        //     '153'   => '96.14',
        //     '15'    => '96.13',
        //     '8'     => '96.11',
        //     '161'   => '95.94',
        //     '186'   => '96.14',
        //     '152'   => '96.14',
        //     '185'   => '96.06',
        //     '173'   => '96.06',
        //     '131'   => '96.07',
        //     '201'   => '96.1',
        //     '124'   => '96',
        //     '112'   => '96.06',
        //     '5'     => '96',
        //     '115'   => '96.06',
        //     '79'    => '96.13',
        //     '54'    => '96.07',
        //     '24'    => '96.17',
        //     '183'   => '96.16',
        //     '19'    => '96.17',
        //     '72'    => '96.06',
        //     '16'    => '96.21',
        //     '5009'  => '96',
        //     '143'   => '96.09',
        //     '157'   => '96.18',
        //     '29'    => '96.18',
        //     '33'    => '96.13',
        //     '154'   => '96',
        //     '58'    => '95.97',
        //     '26'    => '96.11',
        //     '142'   => '96.07',
        //     '146'   => '96.01',
        //     '150'   => '96.14',
        //     '128'   => '97',
        //     '57'    => '95.99',
        //     '46'    => '96.27',
        //     '144'   => '96.19',
        //     '125'   => '96.18',
        //     '202'   => '96.11',
        //     '68'    => '96.91',
        //     '67'    => '96.91',
        //     '121'   => '96.17',
        //     '39'    => '96.03',
        //     '139'   => '96.13',
        //     '148'   => '96.1',
        //     '163'   => '96.13',
        //     '3'     => '96.01',
        //     '136'   => '96',
        //     '129'   => '95.97',
        //     '70'    => '96.07',
        //     '194'   => '96.16',
        //     '12'    => '96.05',
        //     '78'    => '96.13',
        //     '187'   => '96.08',
        //     '4'     => '96.01',
        //     '195'   => '96.02',
        //     '20'    => '95.91',
        //     '55'    => '95.99',
        //     '23'    => '95.99',
        //     '206'   => '96.15',
        //     '98'    => '96.09',
        //     '66'    => '97.02',
        //     '118'   => '96',
        //     '197'   => '96.14',
        //     '122'   => '95.99',
        //     '86'    => '96.05',
        //     '1'     => '96.26',
        //     '135'   => '96.13',
        //     '81'    => '95.98',
        //     '77'    => '96.04',
        //     '102'   => '97.5',
        //     '17'    => '96.02',
        //     '38'    => '96.03',
        //     '42'    => '96.11',
        //     '212'   => '96.16',
        //     '130'   => '96.15',
        //     '104'   => '97.5',
        //     '221'   => '96',
        //     '132'   => '96',
        //     '59'    => '96.09',
        //     '2'     => '96.26',
        //     '27'    => '96.18',
        //     '96'    => '96.26',
        //     '44'    => '96.08',
        //     '209'   => '96.13',
        //     '76'    => '97',
        //     '47'    => '96.17',
        //     '184'   => '96',
        //     '103'   => '97.5',
        //     '51'    => '96.18',
        //     '214'   => '96.18',
        //     '204'   => '96.17',
        //     '80'    => '96.06',
        //     '32'    => '96.19',
        //     '210'   => '96.19',
        //     '13'    => '96.16',
        //     '34'    => '96.06',
        //     '92'    => '96.26',
        //     '21'    => '96.19',
        //     '199'   => '96.16',
        //     '141'   => '97.5',
        //     '35'    => '96.04',
        //     '49'    => '96.17',
        //     '22'    => '96.19',
        //     '95'    => '97',
        //     '36'    => '96.05',
        // ];

        $rtps = [
            '5008'  => '96.18',
            '5007'  => '96.18',
            '203'   => '96.18',
            '52'    => '96.18',
            '7'     => '96.18',
            '179'   => '96.07',
            '105'   => '96.18',
            '31'    => '96.10',
            '133'   => '96.19',
            '111'   => '96.18',
            '10'    => '96.02',
            '64'    => '96.18',
            '137'   => '96.18',
            '160'   => '96.19',
            '99'    => '96.18',
            '127'   => '96.10',
            '208'   => '96.15',
            '50'    => '96.19',
            '117'   => '96.04',
            '109'   => '96.18',
            '108'   => '96.18',
            '188'   => '95.97',
            '69'    => '96.07',
            '116'   => '96.09',
            '180'   => '96.04',
            '113'   => '96.04',
            '140'   => '96.00',
            '89'    => '95.96',
            '147'   => '96.00',
            '123'   => '96.02',
            '138'   => '96.18',
            '182'   => '96.19',
            '205'   => '96.18',
            '9'     => '96.10',
            '83'    => '96.02',
            '74'    => '96.06',
            '153'   => '96.14',
            '15'    => '96.13',
            '8'     => '96.11',
            '161'   => '95.94',
            '186'   => '96.14',
            '152'   => '96.14',
            '185'   => '96.06',
            '173'   => '96.06',
            '131'   => '96.07',
            '201'   => '96.10',
            '124'   => '96',
            '112'   => '96.06',
            '5'     => '96.00',
            '115'   => '96.06',
            '79'    => '96.13',
            '54'    => '96.07',
            '24'    => '96.17',
            '183'   => '96.16',
            '19'    => '96.17',
            '72'    => '96.06',
            '16'    => '96.21',
            '5009'  => '96.00',
            '143'   => '96.09',
            '157'   => '96.18',
            '29'    => '96.18',
            '33'    => '96.13',
            '154'   => '96.00',
            '58'    => '95.97',
            '26'    => '96.11',
            '142'   => '96.07',
            '146'   => '96.01',
            '150'   => '96.14',
            '128'   => '97.00',
            '57'    => '95.99',
            '46'    => '96.27',
            '144'   => '96.19',
            '125'   => '96.18',
            '202'   => '96.11',
            '68'    => '96.91',
            '67'    => '96.91',
            '121'   => '96.17',
            '39'    => '96.03',
            '139'   => '96.13',
            '148'   => '96.10',
            '163'   => '96.13',
            '3'     => '96.01',
            '136'   => '96.00',
            '129'   => '95.97',
            '70'    => '96.07',
            '194'   => '96.16',
            '12'    => '96.05',
            '78'    => '96.13',
            '187'   => '96.08',
            '4'     => '96.01',
            '195'   => '96.02',
            '20'    => '95.91',
            '55'    => '95.99',
            '23'    => '95.99',
            '206'   => '96.15',
            '98'    => '96.09',
            '66'    => '97.02',
            '118'   => '96.00',
            '197'   => '96.14',
            '122'   => '95.99',
            '86'    => '96.05',
            '1'     => '96.26',
            '135'   => '96.13',
            '81'    => '95.98',
            '77'    => '96.04',
            '102'   => '97.50',
            '17'    => '96.02',
            '38'    => '96.03',
            '42'    => '96.11',
            '212'   => '96.16',
            '130'   => '96.15',
            '104'   => '97.50',
            '221'   => '96.00',
            '132'   => '96.00',
            '59'    => '96.09',
            '2'     => '96.26',
            '27'    => '96.18',
            '96'    => '96.26',
            '44'    => '96.08',
            '209'   => '96.13',
            '76'    => '97.00',
            '47'    => '96.17',
            '184'   => '96.00',
            '103'   => '97.50',
            '51'    => '96.18',
            '214'   => '96.18',
            '204'   => '96.17',
            '80'    => '96.06',
            '32'    => '96.19',
            '210'   => '96.19',
            '13'    => '96.16',
            '34'    => '96.06',
            '92'    => '96.26',
            '21'    => '96.19',
            '199'   => '96.16',
            '141'   => '97.50',
            '35'    => '96.04',
            '49'    => '96.17',
            '22'    => '96.19',
            '95'    => '97.00',
            '36'    => '96.05',
            '177'   => '96.19',
            '211'   => '96.17',
            '215'   => '96.20',
            '220'   => '96.15',
            '219'   => '96.18',
            '222'   => '96.17',
            '218'   => '96.19',
            'GB6'   => '96.00',
            'GB12'  => '96.08',
            'GB9'   => '96.08',
            'GB5'   => '96.04',
            'GB8'   => '96.04',
            'GB3'   => '96.04',
            'GB2'   => '96.08',
            'GB13'  => '96.08',
            '171'   => '96.09',
            '242'   => '96.12',
            '241'   => '96.09',
            '243'   => '96.19',
            'GB16'  => '96.20',
            'GB15'  => '96.20',
            '229'   => '96.16',
            '227'   => '96.14',
            '230'   => '96.09',
            '228'   => '96.10',
            '231'   => '96.09',
            '225'   => '96.12',
            '223'   => '96.16',
            '226'   => '96.14'
        ];

        return $rtps[$gameID] ?? 'not found';
    }
}
