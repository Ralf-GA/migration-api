<?php

namespace App\Http\Controllers;

use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Http;
use Laravel\Lumen\Routing\Controller;

class RedMigrateController extends Controller
{
    public function migrate()
    {
        $response = Http::withHeaders([
            'ag-code' => env('RED_AG_CODE'),
            'ag-token' => env('RED_AG_TOKEN')
        ])->post(env('RED_API_URL'), ['language' => 'en'])->json();

        if ($response['status'] != 1) {
            dd($response);
        }

        $pos = 1;

        foreach ($response['game_list'][213] as $game) {

            if ($game['is_enabled'] == 0) continue;

            $requestData[] = [
                'providerCode' => 'RED',
                'providerName' => 'RED TIGER',
                'gameCode' => (string) $game['game_id'],
                'gameName' => $game['game_name'],
                'position' => $pos,
                'type' => 'slot',
                'rtp' => $this->gameRTP($game['game_id']),
                'imageUrl' => '-',
                'imageAlt' => $game['game_name'],
            ];

            $pos++;
        }

        dd($requestData);

        // foreach ($requestData as $data) {
        //     $response = Http::withHeaders([
        //         'Authorization' => 'Bearer ' . env('BEARER_TOKEN_STG')
        //     ])->post('dummyApi.com', $data);
        //     // ])->post(env('ADD_GAME_API_STG'), $data);

        //     Log::info(json_encode([
        //         'request' => $data,
        //         'response' => $response->body()
        //     ]));
        // }
    }

    private function gameRTP($gameID)
    {
        $rtps = [
            57 => '96.24',
            58 => '96.10',
            59 => '96.12',
            60 => '96.07',
            61 => '96.11',
            62 => '96.04',
            63 => '95.72',
            64 => '95.77',
            65 => '95.73',
            66 => '96.28',
            67 => '96.25',
            68 => '96.22',
            69 => '96.22',
            70 => '96.12',
            71 => '96.03',
            72 => '96.09',
            73 => '95.77',
            74 => '96.14',
            75 => '96.18',
            76 => '96.21',
            88 => '95.80',
            89 => '95.72',
            90 => '95.77',
            91 => '95.69',
            92 => '95.71',
            93 => '95.71',
            94 => '95.71',
            95 => '95.75',
            96 => '95.72',
            97 => '95.70',
            98 => '96.20',
            99 => '96.06',
            100 => '96.28',
            101 => '96.24',
            102 => '95.71',
            103 => '95.68',
            104 => '95.72',
            105 => '96.17',
            106 => '95.73',
            107 => '95.71',
            108 => '95.66',
            109 => '96.16',
            110 => '95.76',
            111 => '95.66',
            112 => '95.69',
            113 => '95.66',
            114 => '95.73',
            115 => '95.72',
            116 => '95.69',
            117 => '95.77',
            118 => '96.23',
            119 => '96.15',
            120 => '95.77',
            121 => '95.71',
            122 => '96.17',
            123 => '95.74',
            124 => '96.28',
            125 => '95.73',
            126 => '95.74',
            127 => '99.28',
            128 => '96.22',
            129 => '95.77',
            130 => '95.67',
            131 => '96.06',
            132 => '95.74',
            133 => '96.12',
            134 => '95.72',
            135 => '95.69',
            136 => '95.68',
            137 => '96.12',
            138 => '96.08',
            139 => '96.10',
            140 => '97.30',
            141 => '96.06',
            142 => '96.11',
            143 => '96.18',
            144 => '96.25',
            145 => '96.06',
            146 => '95.75',
            147 => '96.14',
            148 => '95.68',
            149 => '96.07',
            150 => '96.18',
            151 => '95.78',
            152 => '95.72',
            153 => '96.22',
            154 => '96.18',
            155 => '96.20',
            156 => '95.72',
            157 => '96.16',
            158 => '96.30',
            159 => '96.10',
            160 => '96.19',
            161 => '95.77',
            162 => '95.78',
            163 => '96.12',
            164 => '95.75',
            165 => '95.66',
            166 => '96.18',
            167 => '96.02',
            168 => '95.77',
            169 => '96.16',
            170 => '96.12',
            171 => '95.76',
            172 => '96.08',
            173 => '96.14',
            174 => '96.06',
            175 => '96.11',
            176 => '96.17',
            177 => '96.10',
            178 => '95.08',
            179 => '96.26',
            180 => '95.72',
            181 => '96.18',
            182 => '95.67',
            183 => '96.16',
            184 => '96.03',
            185 => '96.30',
            186 => '95.71',
            187 => '96.00',
            188 => '96.29',
            189 => '96.06',
            190 => '98.92',
            191 => '96.23',
            192 => '96.02',
            193 => '96.19',
            194 => '96.06',
            195 => '95.66',
            196 => '95.73',
            197 => '95.73',
            198 => '96.12',
            199 => '96.00',
            200 => '96.03',
            201 => '96.23',
            202 => '96.16',
            203 => '96.13',
            204 => '95.77',
            205 => '96.16',
            206 => '96.08',
            207 => '96.03',
            208 => '95.79',
            209 => '96.08',
            210 => '96.15',
            211 => '96.18',
            212 => '96.05',
            213 => '96.28',
            214 => '96.03',
            215 => '95.66',
            216 => '95.74',
            217 => '96.16',
            218 => '95.76',
            219 => '96.19',
            220 => '96.18',
            221 => '96.20',
            222 => '96.08',
            223 => '96.01',
            224 => '95.69',
            225 => '96.06',
            226 => '96.14',
            227 => '96.05',
            228 => '96.16',
            229 => '95.75',
            281 => '95.71',
            282 => '95.70',
            283 => '95.74',
            284 => '95.67',
            285 => '95.68',
            286 => '95.76',
            287 => '95.66',
            288 => '95.69',
            289 => '95.75',
            290 => '95.69',
            291 => '95.66',
            292 => '95.75',
            296 => '95.67',
            297 => '95.74',
            298 => '95.75',
            299 => '95.67',
            300 => '95.66',
            301 => '95.79',
            302 => '95.75',
            303 => '95.67',
            306 => '95.69',
            307 => '95.77',
            332 => '95.68',
            333 => '95.72',
            334 => '95.72',
            335 => '95.76',
            336 => '95.69',
            360 => '95.74',
            361 => '95.72',
            362 => '95.69',
            363 => '95.79',
            364 => '95.70',
            370 => '95.75',
            371 => '95.76',
            372 => '95.71',
            373 => '95.70',
            374 => '95.67',
            379 => '95.71',
            381 => '95.69',
            382 => '95.75',
            383 => '95.78',
            385 => '95.69',
            386 => '95.75',
            395 => '95.73',
            396 => '95.73',
            397 => '95.74',
            398 => '95.75',
            402 => '95.75',
            403 => '95.74',
            417 => '95.70',
            418 => '95.66',
            419 => '95.66',
            420 => '95.66',
            421 => '95.69',
            422 => '95.76',
            423 => '95.73',
            427 => '95.72',
            491 => '95.72',
            492 => '95.73',
            493 => '95.75',
            494 => '95.76',
            495 => '95.73',
            496 => '95.74',
            497 => '97.66',
            498 => '95.68',
            503 => '95.75',
            504 => '95.74',
            505 => '95.70',
            506 => '95.70',
            507 => '95.69',
            526 => '95.74',
            529 => '95.73',
            530 => '95.76',
            531 => '95.71',
            536 => '95.72',
            564 => '95.66',
            565 => '95.70',
            566 => '96.01',
            567 => '95.69',
            568 => '95.72',
            575 => '95.99',
            576 => '95.75',
            577 => '95.95',
            578 => '95.71',
            583 => '95.89',
            584 => '96.09',
            585 => '96.07',
            586 => '96.07',
            587 => '96.12',
            588 => '96.01',
            589 => '95.87',
            590 => '96.02',
            591 => '96.11',
            592 => '95.89',
            593 => '96.07',
            594 => '95.85',
            595 => '96.10',
            596 => '96.17',
            597 => '96.02',
            598 => '96.05',
            599 => '96.10',
            600 => '96.15',
            601 => '96.08',
            602 => '96.05',
            606 => '96.23',
            607 => '95.69',
            611 => '95.70',
            612 => '95.68',
            618 => '95.71',
            619 => '95.69',
            622 => '95.70',
            624 => '95.71',
            630 => '95.69',
            631 => '95.73',
            634 => '95.68',
            651 => '95.72',
            652 => '95.71',
            655 => '96.02',
            656 => '95.73',
            658 => '95.72',
            662 => '95.63',
            663 => '95.73',
            668 => '95.86',
            669 => '95.73',
            673 => '95.68',
            678 => '95.80',
            683 => '95.69',
            688 => '96.21',
            690 => '95.64',
            691 => '96.28',
            692 => '95.73',
            695 => '95.76',
            696 => '95.69',
            700 => '95.70',
            701 => '95.67',
            702 => '95.78',
            703 => '95.66',
            704 => '96.25',
            706 => '95.68',
            707 => '95.72',
            712 => '95.72',
            715 => '95.68',
            716 => '95.80',
            717 => '96.36',
            723 => '95.74',
            724 => '96.04',
            727 => '95.71',
            730 => '96.65',
            735 => '95.70',
            740 => '96.35',
            741 => '95.70',
            743 => '95.74',
        ];

        return $rtps[$gameID] ?? 'not found';
    }
}
