<?php

namespace App\Http\Controllers;

use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Http;
use Laravel\Lumen\Routing\Controller;

class Cq9StgController extends Controller
{
    public function migrate()
    {
        $response = Http::withHeaders([
            'Authorization' => env('CQ9_AUTH_TOKEN_STG'),
            'Content-Type' => 'application/x-www-form-urlencoded'
        ])->get(env('CQ9_API_URL_STG'))->json();

        if ($response['status']['code'] != '0')
            dd($response);

        $pos = 1;

        $test = [];

        foreach ($response['data'] as $game) {
            if ($game['gametype'] != 'slot') continue;

            $gameName = $game['gamename'];

            foreach ($game['nameset'] as $name) {
                if ($name['lang'] === 'en') {
                    $gameName = $name['name'];
                    break;
                }
            }

            $requestData[] = [
                'providerCode' => 'CQ9',
                'providerName' => 'CQ9',
                'gameCode' => (string) $game['gamecode'],
                'gameName' => $gameName,
                'position' => $pos,
                'type' => $game['gametype'],
                'rtp' => $this->gameRTP($game['gamecode']),
                'imageUrl' => '-',
                'imageAlt' => $gameName,
            ];

            $pos++;
        }

        // dd($test);
        dd($requestData);

        // foreach ($requestData as $data) {
        //     $response = Http::withHeaders([
        //         'Authorization' => 'Bearer ' . env('BEARER_TOKEN_STG')
        //         // ])->post(env('ADD_GAME_API_STG'), $data);
        //     ])->post('dummyApi.com', $data);

        //     Log::info(json_encode([
        //         'request' => $data,
        //         'response' => $response->body()
        //     ]));
        // }
    }

    private function gameRTP($gameID)
    {
        $rtps = [
            '52'     => '96.18%',
            '7'      => '96.18%',
            '179'    => '96.07%',
            '105'    => '96.18%',
            '31'     => '96.10%',
            '133'    => '96.19%',
            '111'    => '96.18%',
            '10'     => '96.02%',
            '64'     => '96.18%',
            '137'    => '96.18%',
            '160'    => '96.19%',
            '99'     => '96.18%',
            '127'    => '96.10%',
            '208'    => '96.15%',
            '50'     => '96.19%',
            '117'    => '96.04%',
            '109'    => '96.18%',
            '108'    => '96.18%',
            '188'    => '95.97%',
            '242'    => '96.12%',
            '69'     => '96.07%',
            '116'    => '96.09%',
            '180'    => '96.04%',
            '113'    => '96.04%',
            '140'    => '96.00%',
            '89'     => '95.96%',
            '147'    => '96.00%',
            '123'    => '96.02%',
            '138'    => '96.18%',
            '182'    => '96.19%',
            '5008'   => '96.18%',
            '205'    => '96.18%',
            'BU01'   => '96.20%',
            '5007'   => '96.18%',
            '9'      => '96.10%',
            '83'     => '96.02%',
            '229'    => '96.16%',
            '227'    => '96.14%',
            '74'     => '96.06%',
            '153'    => '96.14%',
            '15'     => '96.13%',
            '8'      => '96.11%',
            '230'    => '96.09%',
            '161'    => '95.94%',
            '186'    => '96.14%',
            '152'    => '96.14%',
            '185'    => '96.06%',
            '173'    => '96.06%',
            '131'    => '96.07%',
            '201'    => '96.10%',
            '124'    => '96%',
            '112'    => '96.06%',
            '228'    => '96.10%',
            '5'      => '96.00%',
            '115'    => '96.06%',
            '79'     => '96.13%',
            '231'    => '96.09%',
            '54'     => '96.07%',
            '24'     => '96.17%',
            '183'    => '96.16%',
            '177'    => '96.19%',
            '19'     => '96.17%',
            '203'    => '96.18%',
            '72'     => '96.06%',
            '16'     => '96.21%',
            '5009'   => '96.00%',
            'GB6'    => '96.00%',
            '143'    => '96.09%',
            '157'    => '96.18%',
            '29'     => '96.18%',
            '33'     => '96.13%',
            '154'    => '96.00%',
            '58'     => '95.97%',
            '26'     => '96.11%',
            '142'    => '96.07%',
            '146'    => '96.01%',
            '225'    => '96.12%',
            '150'    => '96.14%',
            '128'    => '97.00%',
            '57'     => '95.99%',
            '46'     => '96.27%',
            'GB13'   => '96.08%',
            '220'    => '96.15%',
            'GB12'   => '96.08%',
            '144'    => '96.19%',
            '125'    => '96.18%',
            'GB9'    => '96.08%',
            '211'    => '96.17%',
            '241'    => '96.09%',
            '202'    => '96.11%',
            '1010'   => '96.17%',
            '68'     => '96.91%',
            '67'     => '96.91%',
            '219'    => '96.18%',
            '243'    => '96.19%',
            '121'    => '96.17%',
            'GB16'   => '96.20%',
            '39'     => '96.03%',
            '139'    => '96.13%',
            '148'    => '96.10%',
            '163'    => '96.13%',
            '3'      => '96.01%',
            '136'    => '96.00%',
            '129'    => '95.97%',
            '171'    => '96.09%',
            'GB5'    => '96.04%',
            'GB8'    => '96.04%',
            '70'     => '96.07%',
            '194'    => '96.16%',
            '12'     => '96.05%',
            '78'     => '96.13%',
            '187'    => '96.08%',
            '1074'   => '96.02%',
            '215'    => '96.20%',
            '4'      => '96.01%',
            '195'    => '96.02%',
            '223'    => '96.16%',
            '20'     => '95.91%',
            'GB15'   => '96.20%',
            '55'     => '95.99%',
            '23'     => '95.99%',
            '206'    => '96.15%',
            '98'     => '96.09%',
            '66'     => '97.02%',
            '118'    => '96.00%',
            '197'    => '96.14%',
            '122'    => '95.99%',
            '86'     => '96.05%',
            '226'    => '96.14%',
            '1'      => '96.26%',
            '135'    => '96.13%',
            '81'     => '95.98%',
            '77'     => '96.04%',
            '102'    => '97.50%',
            '17'     => '96.02%',
            '38'     => '96.03%',
            '42'     => '96.11%',
            '212'    => '96.16%',
            '130'    => '96.15%',
            'AR14'   => '93.98%',
            '104'    => '97.50%',
            '221'    => '96.00%',
            '132'    => '96.00%',
            'AR120'  => '95.78%',
            '59'     => '96.09%',
            'BU24'   => '96.11%',
            '2'      => '96.26%',
            '27'     => '96.18%',
            '96'     => '96.26%',
            'AR39'   => '94.00%',
            '44'     => '96.08%',
            '209'    => '96.13%',
            '76'     => '97.00%',
            '47'     => '96.17%',
            '184'    => '96.00%',
            '103'    => '97.50%',
            '51'     => '96.18%',
            'BU27'   => '96.00%',
            '214'    => '96.18%',
            '204'    => '96.17%',
            '222'    => '96.17%',
            '80'     => '96.06%',
            '218'    => '96.19%',
            '32'     => '96.19%',
            '210'    => '96.19%',
            '13'     => '96.16%',
            'GB3'    => '96.04%',
            'AR02'   => '94.94%',
            '34'     => '96.06%',
            'BU31'   => '96.00%',
            'CC01'   => '96.26%',
            'BU14'   => '96.10%',
            '92'     => '96.26%',
            'CC15'   => '96.40%',
            '21'     => '96.19%',
            'AR11'   => '94.12%',
            'AR33'   => '94.17%',
            '199'    => '96.16%',
            'AR12'   => '94.24%',
            'GB2'    => '96.08%',
            'AR80'   => '94.13%',
            'BU23'   => '96.10%',
            '141'    => '97.50%',
            '35'     => '96.04%',
            'AR03'   => '96.11%',
            'AR16'   => '94.24%',
            '49'     => '96.17%',
            'BU32'   => '96.00%',
            'BU05'   => '96.10%',
            'AR23'   => '94.94%',
            'AR01'   => '94.24%',
            '22'     => '96.19%',
            'BU18'   => '96.11%',
            'AR09'   => '93.96%',
            'BU29'   => '96.00%',
            'BU16'   => '96.10%',
            'BU03'   => '96.10%',
            'CC07'   => '96.37%',
            'AR13'   => '93.98%',
            'AR28'   => '93.96%',
            'AR24'   => '94.06%',
            'AR107'  => '94.16%',
            'AR81'   => '94.03%',
            'AR17'   => '94.24%',
            'AR15'   => '94.03%',
            'AR08'   => '94.21%',
            'BU11'   => '96.78%',
            '95'     => '97.00%',
            'BU26'   => '96.03%',
            'AS01'   => '93.30%',
            'BU04'   => '96.10%',
            'BU07'   => '96.11%',
            'AR29'   => '94.03%',
            'AS10'   => '89.30%',
            'AR05'   => '96.49%',
            'AS33'   => '96.00%',
            'AR22'   => '94.06%',
            'AR07'   => '94.15%',
            'AR20'   => '94.03%',
            '1067'   => '96.17%',
            'AR25'   => '94.06%',
            'CC03'   => '96.37%',
            'AR18'   => '94.13%',
            'CC08'   => '95.94%',
            'BU22'   => '96.11%',
            'AR41'   => '94.00%',
            '36'     => '96.05%',
            'CC09'   => '96.43%',
            'BU09'   => '96.10%',
            'BU02'   => '96.18%',
            'AS04'   => '92.30%',
            'AR06'   => '94.10%',
            'AR04'   => '94.06%',
            'AR21'   => '94.03%',
            'BU21'   => '96.10%',
            'BU13'   => '96.10%',
            'BU20'   => '96.10%',
            'AS17'   => '94.90%',
            'BU08'   => '96.07%',
            'AS18'   => '94.10%',
            'AR26'   => '94.94%',
            'BU19'   => '96.10%',
            'AS08'   => '92.30%',
            'BU15'   => '95.90%',
            'BU12'   => '96.10%',
            'AS03'   => '93.00%',
            'AS20'   => '89.30%',
            'BU10'   => '96.09%',
            'AS09'   => '93%',
            'BU30'   => '96.00%',
            'CC02'   => '96.10%',
            'AR37'   => '94.00%',
            'AS02'   => '93.90%',
            'AS19'   => '89.30%',
            'BU25'   => '96.11%',
            'BU06'   => '96.00%',
            'BU28'   => '96.49%'
        ];

        return $rtps[$gameID] ?? 'not found';
    }
}
