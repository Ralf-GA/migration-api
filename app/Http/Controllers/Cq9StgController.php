<?php

namespace App\Http\Controllers;

use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Http;
use Laravel\Lumen\Routing\Controller;

class Cq9StgController extends Controller
{
    public function migrate()
    {
        $response = Http::withHeaders([
            'Authorization' => env('CQ9_AUTH_TOKEN_STG'),
            'Content-Type' => 'application/x-www-form-urlencoded'
        ])->get(env('CQ9_API_URL_STG'))->json();

        if ($response['status']['code'] != '0')
            dd($response);

        $pos = 1;

        foreach ($response['data'] as $game) {
            if ($game['gametype'] != 'slot') continue;

            if ($this->gameRTP($game['gamecode']) == 'not found') {
                $test[] = [
                    'gamecode' => (string) $game['gamecode'],
                    'gamename' => $game['gamename'],
                    'type' => $game['gametype'],
                ];
            }

            // if ($game['gametype'] != 'slot')
            //     $test[] = [
            //         'gametype' => $game['gametype'],
            //         'gameName' => $game['gamename'],
            //         'gameCode' => (string) $game['gamecode'],
            //     ];

            $requestData[] = [
                'providerCode' => 'CQ9',
                'providerName' => 'CQ9',
                'gameCode' => (string) $game['gamecode'],
                'gameName' => $game['gamename'],
                'position' => $pos,
                'type' => $game['gametype'],
                'rtp' => $this->gameRTP($game['gamecode']),
                'imageUrl' => '-',
                'imageAlt' => $game['gamename'],
            ];

            $pos++;
        }

        dd($test);
        // dd($requestData);

        // foreach ($requestData as $data) {
        //     $response = Http::withHeaders([
        //         'Authorization' => 'Bearer ' . env('BEARER_TOKEN_STG')
        //         // ])->post(env('ADD_GAME_API_STG'), $data);
        //     ])->post('dummyApi.com', $data);

        //     Log::info(json_encode([
        //         'request' => $data,
        //         'response' => $response->body()
        //     ]));
        // }
    }

    private function gameRTP($gameID)
    {
        $rtps = [
            '52'    => '96.18',
            'AT01'  => '96',
            '7'     => '96.18',
            '179'   => '96.07',
            'AB3'   => '97',
            '105'   => '96.18',
            '31'    => '96.1',
            '133'   => '96.19',
            '111'   => '96.18',
            '10'    => '96.02',
            '64'    => '96.18',
            'AT05'  => '96',
            '137'   => '96.18',
            '160'   => '96.19',
            '99'    => '96.18',
            '127'   => '96.1',
            '208'   => '96.15',
            '50'    => '96.19',
            '117'   => '96.04',
            '109'   => '96.18',
            'GO02'  => '96.07',
            '207'   => '96',
            '108'   => '96.18',
            '188'   => '95.97',
            '242'   => '96.12',
            '69'    => '96.07',
            '116'   => '96.09',
            '180'   => '96.04',
            '113'   => '96.04',
            '140'   => '96',
            '89'    => '95.96',
            '147'   => '96',
            '123'   => '96.02',
            '138'   => '96.18',
            '182'   => '96.19',
            '5008'  => '96.18',
            '205'   => '96.18',
            'BU01'  => '96.2',
            '224'   => '96.14',
            '5007'  => '96.18',
            '9'     => '96.1',
            '216'   => '97.07',
            'GB11'  => '96',
            '83'    => '96.02',
            '229'   => '96.16',
            '227'   => '96.14',
            '74'    => '96.06',
            '153'   => '96.14',
            '15'    => '96.13',
            '8'     => '96.11',
            '230'   => '96.09',
            'BT03'  => '96',
            '161'   => '95.94',
            '186'   => '96.14',
            '152'   => '96.14',
            '185'   => '96.06',
            '173'   => '96.06',
            '131'   => '96.07',
            '201'   => '96.1',
            '124'   => '96',
            '112'   => '96.06',
            '228'   => '96.1',
            '5'     => '96',
            '115'   => '96.06',
            '79'    => '96.13',
            '196'   => '95.98',
            '231'   => '96.09',
            '54'    => '96.07',
            '24'    => '96.17',
            '183'   => '96.16',
            '177'   => '96.19',
            '19'    => '96.17',
            '203'   => '96.18',
            '72'    => '96.06',
            '16'    => '96.21',
            '60'    => '96',
            '5009'  => '96',
            'GB6'   => '96',
            '143'   => '96.09',
            '157'   => '96.18',
            '29'    => '96.18',
            '33'    => '96.13',
            '61'    => '96.5',
            '154'   => '96',
            '58'    => '95.97',
            'GB14'  => '96.04',
            '26'    => '96.11',
            '142'   => '96.07',
            '146'   => '96.01',
            '225'   => '96.12',
            '150'   => '96.14',
            '128'   => '97',
            '57'    => '95.99',
            '46'    => '96.27',
            'GB13'  => '96.08',
            '220'   => '96.15',
            'GB12'  => '96.08',
            '144'   => '96.19',
            '125'   => '96.18',
            'GB9'   => '96.08',
            '211'   => '96.17',
            '213'   => '96',
            '241'   => '96.09',
            '202'   => '96.11',
            '1010'  => '96.17',
            '68'    => '96.91',
            '67'    => '96.91',
            '219'   => '96.18',
            '243'   => '96.19',
            'BT02'  => '96',
            '121'   => '96.17',
            'GB16'  => '96.2',
            '39'    => '96.03',
            '139'   => '96.13',
            '148'   => '96.1',
            '163'   => '96.13',
            '3'     => '96.01',
            '136'   => '96',
            '129'   => '95.97',
            '171'   => '96.09',
            'GB7'   => '96',
            'GB5'   => '96.04',
            'GB8'   => '96.04',
            '70'    => '96.07',
            '194'   => '96.16',
            '12'    => '96.05',
            'GO03'  => '97',
            '78'    => '96.13',
            '187'   => '96.08',
            '1074'  => '96.02',
            '215'   => '96.2',
            '4'     => '96.01',
            '195'   => '96.02',
            '223'   => '96.16',
            '20'    => '95.91',
            'GB15'  => '96.2',
            '55'    => '95.99',
            '23'    => '95.99',
            '206'   => '96.15',
            '98'    => '96.09',
            '217'   => '96.2',
            '66'    => '97.02',
            '118'   => '96',
            '197'   => '96.14',
            '122'   => '95.99',
            '86'    => '96.05',
            '226'   => '96.14',
            '1'     => '96.26',
            '135'   => '96.13',
            '81'    => '95.98',
            '77'    => '96.04',
            '102'   => '97.5',
            '17'    => '96.02',
            '38'    => '96.03',
            '42'    => '96.11',
            '212'   => '96.16',
            '130'   => '96.15',
            'AR14'  => '93.98',
            '104'   => '97.5',
            '221'   => '96',
            '132'   => '96',
            'AR120' => '95.78',
            '59'    => '96.09',
            'GO01'  => '96.13',
            'BU24'  => '96.11',
            '2'     => '96.26',
            '27'    => '96.18',
            '96'    => '96.26',
            'AR39'  => '94',
            '44'    => '96.08',
            '209'   => '96.13',
            '76'    => '97',
            '47'    => '96.17',
            '184'   => '96',
            '103'   => '97.5',
            '51'    => '96.18',
            'BU27'  => '96',
            '214'   => '96.18',
            '204'   => '96.17',
            '222'   => '96.17',
            '80'    => '96.06',
            '218'   => '96.19',
            '32'    => '96.19',
            '210'   => '96.19',
            '13'    => '96.16',
            'GB3'   => '96.04',
            'AR02'  => '94.94',
            '34'    => '96.06',
            'BU31'  => '96',
            'CC01'  => '96.26',
            'BU14'  => '96.1',
            '92'    => '96.26',
            'CC15'  => '96.4',
            '21'    => '96.19',
            'AR11'  => '94.12',
            'AR33'  => '94.17',
            '199'   => '96.16',
            'AR12'  => '94.24',
            'GB2'   => '96.08',
            'AR80'  => '94.13',
            'BU23'  => '96.1',
            '141'   => '97.5',
            '35'    => '96.04',
            'AR03'  => '96.11',
            'AR16'  => '94.24',
            '49'    => '96.17',
            'BU32'  => '96',
            'BU05'  => '96.1',
            'AR23'  => '94.94',
            'GB198' => '96.16',
            'AR01'  => '94.24',
            '22'    => '96.19',
            'BU18'  => '96.11',
            'AR09'  => '93.96',
            'BU29'  => '96',
            'BU16'  => '96.1',
            'BU03'  => '96.1',
            'CC07'  => '96.37',
            'AR13'  => '93.98',
            'AR28'  => '93.96',
            'AR24'  => '94.06',
            'AR107' => '94.16',
            'AR81'  => '94.03',
            'AR17'  => '94.24',
            'AR15'  => '94.03',
            'GB1'   => '96.99',
            'AR08'  => '94.21',
            'BU11'  => '96.78',
            '95'    => '97',
            'BU26'  => '96.03',
            'AS01'  => '93.3',
            'BU04'  => '96.1',
            'BU07'  => '96.11',
            'AR29'  => '94.03',
            'AS10'  => '89.3',
            'AR05'  => '96.49',
            'AS33'  => '96',
            'AR22'  => '94.06',
            'AR07'  => '94.15',
            'AR20'  => '94.03',
            '1067'  => '96.17',
            'AR25'  => '94.06',
            'CC03'  => '96.37',
            'AR18'  => '94.13',
            'CC08'  => '95.94',
            'BU22'  => '96.11',
            'AR41'  => '94',
            '36'    => '96.05',
            'CC09'  => '96.43',
            'BU09'  => '96.1',
            'BU02'  => '96.18',
            'AS04'  => '92.3',
            'AR06'  => '94.1',
            'AR04'  => '94.06',
            'AR21'  => '94.03',
            '200'   => '96.05',
            'BU21'  => '96.1',
            'BU13'  => '96.1',
            'BU20'  => '96.1',
            'AS17'  => '94.9',
            'BU08'  => '96.07',
            'AS18'  => '94.1',
            'AR26'  => '94.94',
            'BU19'  => '96.1',
            'AS08'  => '92.3',
            'BU15'  => '95.9',
            'BU12'  => '96.1',
            'AS03'  => '93',
            'GO169' => '96.03',
            'AS20'  => '89.3',
            'BU10'  => '96.09',
            'AS09'  => '93',
            'BU30'  => '96',
            'CC02'  => '96.1',
            'AR37'  => '94',
            'AS02'  => '93.9',
            'AS19'  => '89.3',
            'GB10'  => '96',
            'BU25'  => '96.11',
            'BU06'  => '96',
            'CC1001' => '97',
            'BU28'  => '96.49',
            '1200'  => '96.05',
            'CA01'  => '0',
            'CE09'  => '97.5',
            'CE02'  => '97.03',

        ];

        return $rtps[$gameID] ?? 'not found';
    }
}
